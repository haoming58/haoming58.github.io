---
layout: note_with_toc
title: 1. 序列建模基础
description: Basic concepts and principles of sequence modeling
category: Machine Learning
tags: [RNN, Sequence Modeling, Deep Learning, Neural Networks]
permalink: /notes/RNN序列建模基础/
---

## 1.1 什么是序列模型？

有些数据是"有顺序"的，比如：

* 股票价格每天的变化
* 一个人说话时的语音
* 天气的温度变化

这些数据的**顺序不能打乱**，否则意义就全变了。
👉 所以我们需要**序列模型**，来理解"过去会怎样影响未来"。


## 1.2 常见的统计方法

### 1.2.1 自回归模型（AR）

**直观理解**：
预测未来，靠的是"过去的自己"。

* 比如预测今天的股票价格，我们可以参考前几天的价格。
* 但数据太多会很麻烦，所以只看最近的一段（比如最近 3 天），这就叫**窗口 $\tau$**。

公式写出来：

$$
x_t = P(x_t \mid x_{t-1}, x_{t-2}, \ldots, x_{t-\tau})
$$

📌 **生活类比**
就像你复习考试，只需要看最近几天的复习笔记，不可能把所有学过的都重新背一遍。


### 1.2.2 隐变量自回归模型（Latent AR）

问题来了：
如果历史特别长（比如看 1 年的股价），光靠窗口还是太复杂。

于是我们想了个办法：
👉 用一个"总结笔记" $h_t$，把过去的内容都总结进去。
以后预测的时候，就直接参考这份总结，而不是看所有历史。

公式：

$$
x_t \sim P(x_t \mid h_t), \quad h_t = f(h_{t-1}, x_{t-1})
$$

📌 **生活类比**
就像上课时，你不会把老师说的每一句话都记下来，而是做一份"课堂总结"。以后复习考试时，你看的是总结，而不是完整课堂录音。



### 1.2.3 马尔可夫模型

马尔可夫模型的思想很简单：
👉 **未来只依赖最近的情况，不依赖更久远的历史。**

* 如果只依赖"上一刻"的状态，这叫"一阶马尔可夫"。
* 比如预测明天天气，只看今天的天气，不看更久之前的。

公式：

$$
P(x_{t+1} \mid x_1,\ldots,x_t) = P(x_{t+1} \mid x_t)
$$

📌 **生活类比**
你决定明天要不要带伞，通常只看今天的天气，不会去管一个月前的天气。


### 1.2.4 因果关系

概率的公式可以随便换顺序，但时间可不是。

👉 现实生活里，**过去影响未来，但未来不能影响过去**。

* 解释 $P(z_{t+1} \mid z_t)$（未来依赖于现在）是合理的；
* 解释 $P(z_t \mid z_{t+1})$（现在依赖未来）就不符合因果关系。

📌 **生活类比**
你今天是否会下雨，不能由"明天会不会下雨"来决定。



这样讲下来：

* 自回归模型：看过去几步
* 隐变量模型：做总结笔记
* 马尔可夫模型：未来只看最近
* 因果关系：只能"由前推后"

---
